---
id: S-29
status: complete
step: complete
milestone: parallel-state
started: 2026-02-22
updated: 2026-02-22
tests: 43
security_tests: 0
session:
deps: S-28
---

# S-29: Init Command and State Detection

## Why
New projects need to use file-per-slice state from day one. The init command currently creates a monolithic STATE.md. It must be updated to create the slices/ directory, individual slice files, and project-state.json instead.

## What
Update `/gl:init` to create `.greenlight/slices/` directory with individual slice files and `.greenlight/project-state.json`. Implement state format detection logic (directory existence check) that all commands follow.

## Dependencies
- S-28: Slice State Foundation Documents (must define schema and detection rules first)

## Contracts
- C-78: InitSliceFileCreation
- C-79: InitProjectStateCreation
- C-80: StateFormatDetection

## Decisions
- 2026-02-22: Added Phase 6a/6b to init.md rather than replacing Phase 6 — preserves legacy path
- 2026-02-22: State detection documented inline in init.md with reference to state-format.md as single source of truth

## Files
- src/commands/gl/init.md (modified — +183 lines)
- internal/installer/init_state_detection_test.go (new — 370 lines, 43 tests)
